<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mapping Chili Peppers</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
    }
    header {
      text-align: center;
      font-weight: bold;
      padding: 10px;
      background-color: #f8f9fa;
      border-bottom: 1px solid #ddd;
    }
    #map {
      flex-grow: 1;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    footer {
      background-color: #f8f9fa;
      text-align: center;
      padding: 10px 0;
      font-size: 0.9em;
      border-top: 1px solid #ddd;
      flex-shrink: 0;
      margin: 0;
    }
    .timeline-container {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      z-index: 1000;
    }
    .timeline-container input {
      width: 100%;
    }
  </style>
</head>

<body>
  <header>Mapping Chili Peppers Across the World</header>

  <!-- ðŸŽµ Audio -->
  <audio id="intro-audio" preload="auto">
    <source src="path/to/red-hot-chili-peppers-intro.mp3" type="audio/mpeg">
  </audio>

  <!-- Modal Popup -->
  <div class="modal fade" id="overlay" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Mapping Chili Peppers: A Global Journey</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>From the highlands of Central and South America to dinner tables around the globe, chili peppers have conquered the world with their irresistible heat and vibrant flavors.</p>
          <p> This interactive map traces how this humble spice traveled across the continents to become the absolute star of global cuisine. Use the timeline slider below to explore key moments in history when chili peppers made their mark in different places around the world.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const overlayModal=new bootstrap.Modal(document.getElementById('overlay'));
    overlayModal.show();
  </script>

  <!-- Map -->
  <div id="map"></div>

  <!-- Timeline Slider -->
  <div class="timeline-container">
    <label for="yearSlider">Select Year: <span id="selectedYear">1492</span></label>
    <input type="range" id="yearSlider" min="1492" max="1900" value="1492" step="1">
  </div>

  <!-- Leaflet + Bootstrap JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    

    // Initialize map centered on Brazil
    var map = L.map('map').setView([-14.2350, -51.9253], 3);

    // Light muted map style (CartoDB Positron)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
    }).addTo(map);

    // overlay for map tint to add a soft warmth
    L.rectangle([[-90, -180], [90, 180]], {
      color: "#FF4500",
      weight: 0,
      fillOpacity: 0.03
    }).addTo(map);

    // Show modal + play audio when map loads
    map.whenReady(function () {
      const overlayModal = new bootstrap.Modal(document.getElementById('overlay'));
      overlayModal.show();

      const audio = document.getElementById('intro-audio');
      audio.volume = 0.5;
      audio.play().catch(err => {
        console.warn("Autoplay blocked:", err);
      });
    });

    //  Dataset (copy for each point)
    const dataset1 = [{
      type: 'Feature',
      geometry: { type: 'Point', coordinates: [-2.0791, 42.4247] }, //longitude, latitude
      properties: {
        title: 'Lodosa, Spain', //Title
        description: 'Chilies were in regular use as a culinary ingredient.', //add description
        time: '1513', //update date
        icon: {
          iconUrl: 'images/food.png', //flaticon image here,
          iconSize: [40, 40],
          iconAnchor: [20, 40],
          popupAnchor: [0, -40]
        },
      }
    }];
    const dataset2 = [{
  type: 'Feature',
  geometry: { type: 'Point', coordinates: [120.1667, 30.2500] }, //longitude, latitude
  properties: {
    title: 'Hangzhou', //Title
    description: 'The earliest time it appeared in local gazetteer, the entry date to Hangzhou was probably earlier.', //add description
    time: '1591', //update date
    icon: {
      iconUrl: 'images/food.png', //flaticon image here,
      iconSize: [40, 40],
      iconAnchor: [20, 40],
      popupAnchor: [0, -40]
    },
  }
}];

    // Add marker to map
    dataset1.forEach(pepper => {
      const marker = L.marker(
        [pepper.geometry.coordinates[1], pepper.geometry.coordinates[0]],
        { icon: L.icon(pepper.properties.icon) }
      );
      marker.bindPopup(
        `<b>${pepper.properties.title}</b><br>${pepper.properties.description}<br><img src="${pepper.properties.image}" width="200px">`
      );
      marker.addTo(map);
    });

dataset2.forEach(pepper => {
  const marker = L.marker(
    [pepper.geometry.coordinates[1], pepper.geometry.coordinates[0]],
    { icon: L.icon(pepper.properties.icon) }
  );
  marker.bindPopup(
    `<b>${pepper.properties.title}</b><br>${pepper.properties.description}`
  );
  marker.addTo(map);
});
    // Slider update
    const yearSlider = document.getElementById("yearSlider");
    const selectedYear = document.getElementById("selectedYear");
    yearSlider.addEventListener("input", () => {
      selectedYear.textContent = yearSlider.value;
    });
  </script>

  <footer>
    &copy; 2025 Chili Mapping Project | Data Sources:
    <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a>,
    <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>
  </footer>
</body>
</html>

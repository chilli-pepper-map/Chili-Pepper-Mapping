<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mapping Chili Peppers</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
    }

 header {
  text-align: center;
  font-weight: 700;
  font-size: 2.8rem;
  letter-spacing: 1px;
  padding: 40px 20px;
  color: #fdfaf6;
  background: linear-gradient(135deg, #8b2e1a, #b94527, #d66b3c);
  background-size: 200% 200%;
  animation: slowGlow 12s ease infinite;
  border-bottom: 3px solid rgba(0, 0, 0, 0.1);
  text-shadow: 0 3px 6px rgba(0, 0, 0, 0.25);
  font-family: "Playfair Display", "Georgia", serif;
}

/* Gentle movement of warmth */
@keyframes slowGlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Optional subtle accent underline */
header::after {
  content: "";
  display: block;
  width: 70px;
  height: 3px;
  background-color: rgba(253, 250, 246, 0.6);
  margin: 12px auto 0;
  border-radius: 2px;
}


    #map {
      flex-grow: 1;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    footer {
      background-color: #f8f9fa;
      text-align: center;
      padding: 10px 0;
      font-size: 0.9em;
      border-top: 1px solid #ddd;
      flex-shrink: 0;
      margin: 0;
    }
    .timeline-container {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      z-index: 1000;
    }
    .timeline-container input {
      width: 100%;
    }
   
.leaflet-tile {
    filter: sepia(30%) saturate(80%) brightness(95%);
  }

  /*Modal*/
  .modal-content {
  background: linear-gradient(135deg, #8b2e1a, #b94527, #d66b3c);
  color: #fdfaf6;
  border: none;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(139, 46, 26, 0.5);
  animation: modalGlow 8s ease-in-out infinite alternate;
}
@keyframes modalGlow {
  0% { box-shadow: 0 0 12px rgba(139, 46, 26, 0.4); }
  100% { box-shadow: 0 0 28px rgba(214, 107, 60, 0.6); }
}
.modal-title {
  font-family: "Playfair Display", "Georgia", serif;
  font-weight: 700;
  letter-spacing: 1px;
  color: #fffaf0;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}
.modal-body {
  font-family: "Merriweather", "Georgia", serif;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  padding: 20px;
  color: #fffaf0;
  line-height: 1.6;
}
  /* Controls styling */
  .leaflet-control-zoom a {
    background: #b94527 !important;
    color: #fdfaf6 !important;
    border: none !important;
  }
  .leaflet-control-zoom a:hover {
    background: #8b2e1a !important;
  }
  </style>

   <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/elfalem/Leaflet.curve/leaflet.curve.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-polylinedecorator/1.7.0/leaflet.polylineDecorator.min.js"></script>

</head>

<body>
  <header>Mapping Chili Peppers: A Global Journey</header>

  <!-- Modal Popup -->
  <div class="modal fade" id="overlay" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Mapping Chili Peppers: A Global Journey</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>From the highlands of Central and South America to dinner tables around the globe, chili peppers have conquered the world with their irresistible heat and vibrant flavors.</p>
          <p> This interactive map traces how this humble spice traveled across the continents to become the absolute star of global cuisine. Use the timeline slider below to explore key moments in history when chili peppers made their mark in different places around the world.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <!-- Timeline Slider -->
  <div class="timeline-container">
    <label for="yearSlider">Select Year: <span id="selectedYear">1492</span></label>
    <input type="range" id="yearSlider" min="1492" max="1900" value="1492" step="1">
  </div>

   <audio id="pepperSound" src="audio/onclick.mp3" preload="auto"></audio>

  <!-- Bootstrap JS-->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Initialize map centered on Brazil
    var map = L.map('map').setView([-14.2350, -51.9253], 3);

     // Use a warm-toned tile provider
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19,
    attribution: "© OpenStreetMap contributors",
  }).addTo(map);

    // Datasets 
    const dataset1 = [
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [120.1667, 30.2500] },
        properties: {
          title: 'Hangzhou',
          description: 'Chili peppers first appear in Hangzhou\'s local gazetteer in 1591, though they likely arrived earlier. This marks the earliest recorded appearance of chili peppers in central coastal China.',
          time: '1591',
          icon: { iconUrl: 'images/food.png', iconSize: [40, 40], iconAnchor: [20, 40], popupAnchor: [0, -40] }
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [74.1240, 15.2993] },
        properties: {
          title: 'Goa',
          description: 'Following the Portuguese conquest of Goa in 1510, chili peppers quickly took root here. The earliest records from 1542 confirm that chili cultivation was already well-established. Historian Brian R. Dott suggests the peppers were likely introduced sometime in the early 1500s, shortly after Portuguese arrival.',
          time: '1542',
          icon: { iconUrl: 'images/food.png', iconSize: [40, 40], iconAnchor: [20, 40], popupAnchor: [0, -40] }
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [123.4330, 41.8048] },
        properties: {
          title: 'Fengtian',
          description: 'The earliest record of chili peppers in northeastern China comes from Fengtian (an old name for Shenyang) in 1682. Historian Brian R. Dott estimates the initial introduction likely occurred around the 1650s via Korea.',
          time: '1682',
          icon: { iconUrl: 'images/food.png', iconSize: [40, 40], iconAnchor: [20, 40], popupAnchor: [0, -40] }
        }
      },
       {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [127.726, 37.658] },
        properties: {
          title: 'Korea',
          description: 'The earliest known record of chili peppers on the Korean Peninsula dates to 1614, though the introduction must have occurred earlier. Historian Brian R. Dott estimates the peppers likely arrived in the 1590s during the Japanese invasions of Korea.',
          time: '1614',
          icon: { iconUrl: 'images/food.png', iconSize: [40, 40], iconAnchor: [20, 40], popupAnchor: [0, -40] }
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [102.2501, 2.1896] },
        properties: {
          title: 'Malacca',
          description: 'According to Brian R. Dott, Chilli peppers were likely introduced to the Malacca area by 1540.',
          time: '1614',
          icon: { iconUrl: 'images/food.png', iconSize: [40, 40], iconAnchor: [20, 40], popupAnchor: [0, -40] }
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [-2.0791, 42.4247] },
        properties: {
          title: 'Lodosa, Spain',
          description: 'Chilies were in regular use as a culinary ingredient.',
          time: '1513',
          icon: {
            iconUrl: 'images/food.png',
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [-8.2245, 39.399] },
        properties: {
          title: 'Portugal',
          description: 'The Portuguese, who discovered chilies (in Latin America) of their own accord in Brazil in 1500.',
          time: '1500',
          icon: {
            iconUrl: 'images/food.png',
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type:'Feature',
        geometry: {type: 'Point', coordinates: [28.9784, 41.0082]}, 
        properties: {
          title: 'Ottoman Empire',
          description: 'After having successfully raided the Portuguese colony of Diu in India, the Ottomans could not contain their ebullience over discovering such a culinary treasure. From India, Ottomon Turks brought the chili pepper everywhere they went, taking it to Bulgaris and then Hungary.',
          time: '1538',
          icon: {
            iconUrl: 'images/food.png',
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type:'Feature',
        geometry: {type: 'Point', coordinates: [19.0402,47.4979]}, 
        properties: {
          title: 'Hungary',
          description: 'After the introduction of chilies in the second half of the sixteenth century, Hungarian tables were set with salt and paprika, not black pepper. Paprike started out as a cheap alternative to prohibitively expensive pepper, making it an obvious hit with the peasantry, and from there it climbed the social ladder. When the trend-setting aristocrat Margit Szechy planted paprika in her garden in 1569, the spice began its slow ascent towards the kitchen.',
          time: '1569',
          icon: {
            iconUrl: 'images/food.png',
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [16.3464, 39.3088] },
        properties: {
          title: 'Calabria, Italy',
          description: 'Peppers were introduced to Italy from neighboring Spain early on, but it was centuries before they were widely used.',
          time: '1790',
          icon: {
            iconUrl: 'images/food.png',
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [2.347, 48.802] }, //longitude, latitude
        properties: {
          title: 'France', //Title
          description: 'With their hot climates and rich, river-born soils, before long the towns of Kalocsa and Szeged in Hungary became epicenters of paprika production. Bolstered by the cheerleading of the prominent chef Georges-Auguste Escoffier in the later 1870s, France experienced its first bout of Hungary fever, and la cuisine a la hongroise took hold of French restaurants.', //add description
          time: '1870', //update date
          icon: {
            iconUrl: 'images/food.png', //flaticon image here,
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [120.9605, 23.6978] }, //longitude, latitude
        properties: {
          title: 'Taiwan', //Title
          description: 'Brian R. Dott estimates that the Dutch introduced chili pepper into Taiwan.', //add description
          time: '1640', //update date
          icon: {
            iconUrl: 'images/food.png', //flaticon image here,
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [6.6131, 0.1864] }, //longitude, latitude
        properties: {
          title: 'West Africa (São Tomé)', //Title
          description: 'According to Nathan Nunn and Nancy Qian, "By 1493, capsicum peppers had arrived in Spain and Africa." By 1493, the Portugese already had trading ports in West Africa; this is the location of one such trading port. According to Jean Andrews, "after 1493, peppers from the Spanish Main were available to Portuguese for trade in their western African colonies."', //add description
          time: '1493', //update date
          icon: {
            iconUrl: 'images/food.png', //flaticon image here,
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [35.5296, -18.6657] }, //longitude, latitude
        properties: {
          title: 'Mozambique', //Title
          description: 'Vasco da Gama\'s arrival marks the earliest possible date of the chili pepper introduction.', //add description
          time: '1498', //update date
          icon: {
            iconUrl: 'images/food.png', //flaticon image here,
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      },
      {
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [129.873, 32.747] }, //longitude, latitude
        properties: {
          title: 'Nagasaki', //Title
          description: 'According to Brian R. Dott, chilies likely entered Japan after the establishment of a Dutch trading post at Nagasaki in 1571.', //add description
          time: '1571', //update date
          icon: {
            iconUrl: 'images/food.png', //flaticon image here,
            iconSize: [40, 40],
            iconAnchor: [20, 40],
            popupAnchor: [0, -40]
          },
        }
      }
    ];

    // Audio for Pepper Icons
const pepperSound = document.getElementById("pepperSound");

// Create markers from dataset with sound
const pepperMarkers = dataset1.map(feature => {
  const [lon, lat] = feature.geometry.coordinates;
  const marker = L.marker([lat, lon], { icon: L.icon(feature.properties.icon) });

  marker.bindPopup(`<b>${feature.properties.title}</b><br>${feature.properties.description}`);

  // Play sound when pepper icon is clicked
  marker.on("click", () => {
    pepperSound.currentTime = 0;
    pepperSound.play().catch(err => console.log("Audio play error:", err));
  });

  marker.feature = feature;
  return marker;
});
    
 //Timeline slider
 const yearSlider= document.getElementById("yearSlider");
 const selectedYear= document.getElementById("selectedYear");

 yearSlider.addEventListener("input", () => {
  const currentYear= parseInt(yearSlider.value);
  selectedYear.textContent=currentYear;

  //Remove all markers first 
  pepperMarkers.forEach(m => map.removeLayer(m));

  //Then add only those up to current year 
  pepperMarkers.forEach(m => {
    if (m.feature.properties.time <= currentYear){
      m.addTo(map);
    }
  });
 });

 //Show initial state 
 yearSlider.dispatchEvent(new Event('input'));

// Show modal on page load
document.addEventListener("DOMContentLoaded", function () {
  const modalElement = document.getElementById("overlay");
  const modal = new bootstrap.Modal(modalElement);
  modal.show();
});

</script>

  <footer>
    &copy; 2025 Chili Mapping Project | Data Sources:
    <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a>,
    <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>
  </footer>
</body>
</html>
